<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RR IMPERIAL ELECTRICALS LTD.</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f4f6f8}
header{background:#0a3d62;color:#fff;padding:12px;text-align:center;font-size:18px;font-weight:bold}
.container{display:flex}
.sidebar{width:90px;background:#1e3799;color:#fff;min-height:100vh}
.sidebar button{width:100%;padding:15px;border:none;background:none;color:#fff;font-size:12px}
.sidebar button.active{background:#4a69bd}
.main{flex:1;padding:10px}

.card{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px}
input,select,button{width:100%;padding:8px;margin-top:6px}
button{background:#1e3799;color:#fff;border:none;border-radius:6px}
button.danger{background:#e55039}
button.gray{background:#7f8c8d}
.summary{display:flex;gap:6px}
.box{flex:1;background:#dff9fb;padding:6px;border-radius:6px;text-align:center;font-size:12px}

table{width:100%;border-collapse:collapse;font-size:11px}
th,td{border:1px solid #ccc;padding:4px;text-align:center}

.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5)}
.modal-content{background:#fff;margin:15% auto;padding:15px;width:90%;border-radius:8px}
</style>
</head>

<body>

<header>RR IMPERIAL ELECTRICALS LTD.</header>

<div class="container">
  <div class="sidebar">
    <button onclick="showTab('manpower')" class="active">Manpower</button>
    <button onclick="showTab('sports')">Sports Register</button>
  </div>

  <div class="main">

    <!-- MANPOWER -->
    <div id="manpower">
      <div class="summary">
        <div class="box">Total<br><b id="totalMp"></b></div>
        <div class="box">Participate<br><b id="totalJoin"></b></div>
        <div class="box">Left<br><b id="leftMp"></b></div>
      </div>

      <div class="card">
        <b>Individual Registration</b>
        <input id="searchId" placeholder="Employee ID">
        <button onclick="searchEmp()">Search</button>
        <button class="gray" onclick="clearSearch()">Clear</button>
      </div>
    </div>

    <!-- SPORTS REGISTER -->
    <div id="sports" style="display:none">
      <div class="card">
        <b>Overview Summary</b>
        <div id="overview"></div>
      </div>

      <div class="card">
        <button onclick="downloadPDF()">Download PDF</button>
        <div id="sportList"></div>
      </div>
    </div>

  </div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <div id="empInfo"></div>
    <select id="sportSel">
      <option value="">Select Sports</option>
      <option>Tug Of War (দড়ি টানা)</option>
      <option>Pot Breaking (হাড়ি ভাংগা)</option>
      <option>Sack Race (বস্তা দৌড়)</option>
      <option>Basket Toss (ঝুড়িতে বল নিক্ষেপ)</option>
      <option>Musical Chair (মিউজিক্যাল চেয়ার)</option>
    </select>
    <button onclick="register()">Done</button>
    <button class="danger" onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
const manpower = [
  {id:"20110",name:"Krishibid Sadeque ibn Shams",dept:"Administration",des:"Chief Co-Ordinator"},
  {id:"20103",name:"Mohammad Sharif Ahmed",dept:"Operation",des:"Factory Manager"},
  {id:"20801",name:"Subhasis Bakul Chandra Ghosh",dept:"Maintenance",des:"Manager"},
  {id:"20107",name:"Md. Mostafizur Rahman",dept:"Accounts",des:"Dpt. Manager"},
  {id:"20112",name:"Mohammad Forkan",dept:"Accounts",des:"Executive"},
  // ⚠️ demo রাখা হয়েছে, চাইলে পুরো লিস্ট আমি Auto Inject করে দিতে পারি
];

let selectedEmp=null;
let reg=JSON.parse(localStorage.getItem("sportsReg")||"[]");

function showTab(t){
  manpowerTab=document.getElementById("manpower");
  sportsTab=document.getElementById("sports");
  manpowerTab.style.display=t=="manpower"?"block":"none";
  sportsTab.style.display=t=="sports"?"block":"none";
}

function refresh(){
  totalMp.innerText=manpower.length;
  totalJoin.innerText=reg.length;
  leftMp.innerText=manpower.length-reg.length;

  let ov={};
  reg.forEach(r=>ov[r.sport]=(ov[r.sport]||0)+1);
  overview.innerHTML="";
  for(let k in ov) overview.innerHTML+=`<div class="box">${k}<br><b>${ov[k]}</b></div>`;

  sportList.innerHTML="";
  reg.forEach((r,i)=>{
    sportList.innerHTML+=`
    <table>
      <tr><th>${r.sport}</th></tr>
      <tr><td>${r.id} - ${r.name}</td></tr>
      <tr>
        <td>
          <button onclick="del(${i})" class="danger">Delete</button>
        </td>
      </tr>
    </table><br>`;
  });
}

function searchEmp(){
  let id=searchId.value;
  selectedEmp=manpower.find(e=>e.id==id);
  if(!selectedEmp){alert("Not Found");return;}
  empInfo.innerHTML=`<b>${selectedEmp.name}</b><br>${selectedEmp.dept}<br>${selectedEmp.des}`;
  modal.style.display="block";
}

function register(){
  let sport=sportSel.value;
  if(!sport){alert("Select sport");return;}
  if(reg.find(r=>r.id==selectedEmp.id)){alert("Already Registered");return;}
  reg.push({...selectedEmp,sport});
  localStorage.setItem("sportsReg",JSON.stringify(reg));
  closeModal();refresh();alert("Registration Successful");
}

function del(i){
  if(confirm("Delete?")){
    reg.splice(i,1);
    localStorage.setItem("sportsReg",JSON.stringify(reg));
    refresh();
  }
}

function closeModal(){modal.style.display="none"}
function clearSearch(){searchId.value=""}

function downloadPDF(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF();
  let y=10;
  reg.forEach(r=>{
    pdf.text(`${r.sport} - ${r.id} ${r.name}`,10,y);
    y+=8;
  });
  pdf.save("Sports_List.pdf");
}

refresh();
</script>

</body>
</html>
